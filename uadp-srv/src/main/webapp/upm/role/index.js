webpackJsonp([4],{0:function(e,t,l){e.exports=l(347)},344:function(e,t,l){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){function t(){r({type:"updateRoleModule",params:{selectedModules:o}})}function l(e){a&&r({type:"checkModules",params:e})}var r=e.dispatch,a=e.isSet,o=e.selectedModules,u=e.visible,d=e.loading,s=e.moduleTree,f=a?"\u8bbe\u7f6e\u529f\u80fd\u6a21\u5757":"\u67e5\u770b\u529f\u80fd\u6a21\u5757",p=function e(t){return t.map(function(t){return t.children&&t.children.length>0?y.default.createElement(v,{title:t.name,key:""+t.key},e(t.children)):y.default.createElement(v,{title:t.name,key:""+t.key,isLeaf:t.isLeaf})})},m=y.default.createElement("div",null,y.default.createElement(i.default,{onClick:function(){return r({type:"closeModuleModal"})}},"\u8fd4\u56de"),a?y.default.createElement(i.default,{type:"primary",loading:d,onClick:function(e){return t()}},"\u4fdd\u5b58"):"");return y.default.createElement(n.default,{title:f,width:400,footer:m,visible:u,onCancel:function(e){return r({type:"closeModuleModal"})}},y.default.createElement("div",{className:"overflow"},y.default.createElement(c.default,{checkable:!0,defaultExpandedKeys:o,checkedKeys:o,onCheck:l},p(s))))}function o(e){return{isSet:e.moduleProps.isSet,selectedModules:e.moduleProps.selectedModules,visible:e.moduleProps.visible,loading:e.moduleProps.loading,moduleTree:e.moduleProps.moduleTree}}Object.defineProperty(t,"__esModule",{value:!0});var u=(l(22),l(21)),n=r(u),d=(l(27),l(25)),i=r(d),s=(l(110),l(109)),c=r(s),f=(l(36),l(35)),p=r(f),m=l(1),y=r(m),g=l(15);l(446);var v=(p.default.Item,c.default.TreeNode);t.default=(0,g.connect)(o)(a),e.exports=t.default},345:function(e,t,l){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){function t(){a.validateFields(function(e,t){e||r({type:"saveRole",params:t})})}function l(){a.resetFields()}var r=e.dispatch,a=e.form,o=e.isNew,u=e.editData,d=e.visible,s=e.loading,f=e.orgType,m=e.currentUserType,g=a.getFieldDecorator,M={labelCol:{span:8},wrapperCol:{span:14},style:{marginBottom:5}},h=o?"\u65b0\u589e\u89d2\u8272":"\u7f16\u8f91\u89d2\u8272";return v.default.createElement(n.default,{title:h,width:620,okText:"\u4fdd\u5b58",cancelText:"\u8fd4\u56de",visible:d,confirmLoading:s,onOk:function(e){return t()},onCancel:function(){return r({type:"closeRoleModal"})},afterClose:l},v.default.createElement(y.default,null,g("id",{initialValue:u.id})(v.default.createElement(p.default,{type:"hidden"})),g("toOrgId",{initialValue:u.toOrgId})(v.default.createElement(p.default,{type:"hidden"})),v.default.createElement(T,(0,c.default)({},M,{label:"\u89d2\u8272\u540d\u79f0"}),g("name",{initialValue:u.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0\uff01"}]})(v.default.createElement(p.default,{autoComplete:"off"}))),v.default.createElement(T,(0,c.default)({},M,{label:"\u89d2\u8272\u4ee3\u7801"}),g("code",{initialValue:u.code})(v.default.createElement(p.default,{autoComplete:"off"}))),v.default.createElement(T,(0,c.default)({},M,{label:"\u89d2\u8272\u63cf\u8ff0"}),g("remark",{initialValue:u.remark})(v.default.createElement(p.default,{type:"textarea",autosize:!0,autoComplete:"off"}))),"1"!=m?"":v.default.createElement(T,(0,c.default)({},M,{label:"\u662f\u5426\u5168\u5c40"}),g("isGlobal",{initialValue:null==u.isGlobal?"0":""+u.isGlobal})(v.default.createElement(i.default,{onChange:function(e){return r({type:"isGlobalChange",scope:"self",params:e})}},v.default.createElement(i.default.Option,{key:"1",value:"1"},"\u662f"),v.default.createElement(i.default.Option,{key:"0",value:"0"},"\u5426")))),"1"==u.isGlobal?v.default.createElement(T,(0,c.default)({},M,{label:"\u9002\u7528\u8303\u56f4"}),g("orgType",{initialValue:u.orgType})(v.default.createElement(i.default,null,f.map(function(e,t){if(e.code)return v.default.createElement(i.default.Option,{key:e.code,value:e.code},e.value)})))):""))}function o(e){return{isNew:e.roleProps.isNew,editData:e.roleProps.editData,visible:e.roleProps.visible,loading:e.roleProps.loading,orgType:e.roleProps.orgType,currentUserType:e.currentUserType}}Object.defineProperty(t,"__esModule",{value:!0});var u=(l(22),l(21)),n=r(u),d=(l(83),l(65)),i=r(d),s=l(2),c=r(s),f=(l(20),l(26)),p=r(f),m=(l(36),l(35)),y=r(m),g=l(1),v=r(g),M=l(15),T=y.default.Item;t.default=(0,M.connect)(o)(y.default.create()(a)),e.exports=t.default},346:function(e,t,l){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=e.dispatch,l=e.dataSource,r=p.default.createElement("div",null,p.default.createElement(c.default,{type:"primary",icon:"plus",onClick:function(){return t({type:"openRoleModal",params:{isNew:!0,editData:{}}})}},"\u65b0\u589e\u89d2\u8272")),a=[{title:"\u7ec4\u7ec7\u673a\u6784",dataIndex:"toOrgName",key:"toOrgName",width:200},{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name",key:"name",width:200},{title:"\u89d2\u8272\u4ee3\u7801",dataIndex:"code",key:"code",width:200},{title:"\u89d2\u8272\u63cf\u8ff0",dataIndex:"remark",key:"remark",width:200},{title:"\u662f\u5426\u5168\u5c40",dataIndex:"isGlobal",key:"isGlobal",width:100,render:function(e,t,l){return"1"==t.isGlobal?"\u662f":"\u5426"}},{title:"\u64cd\u4f5c",width:200,render:function(e,l,r){var a=l.isFixed||!l.isLocalRole?"disabled":null;return p.default.createElement("span",null,p.default.createElement(i.default,{title:"\u4fee\u6539\u89d2\u8272"},p.default.createElement(c.default,{onClick:function(e){return t({type:"openRoleModal",params:{isNew:!1,editData:l}})},size:"small",type:"ghost",shape:"circle",icon:"edit",disabled:a,style:{marginRight:5}})),p.default.createElement(i.default,{title:"\u5220\u9664\u89d2\u8272"},p.default.createElement(c.default,{onClick:function(e){return t({type:"deleteRole",params:{roleId:l.id}})},size:"small",type:"ghost",shape:"circle",icon:"close",disabled:a,style:{marginRight:5}})),p.default.createElement(i.default,{title:"\u8bbe\u7f6e\u529f\u80fd\u6a21\u5757"},p.default.createElement(c.default,{onClick:function(e){return t({type:"openModuleModal",params:{roleId:l.id,isSet:!0}})},size:"small",type:"ghost",shape:"circle",icon:"setting",disabled:a,style:{marginRight:5}})),p.default.createElement(i.default,{title:"\u67e5\u770b\u529f\u80fd\u6a21\u5757"},p.default.createElement(c.default,{onClick:function(e){return t({type:"openModuleModal",params:{roleId:l.id,isSet:!1}})},size:"small",type:"ghost",shape:"circle",icon:"bars"})))}.bind(this)}];return p.default.createElement(m.Layout,null,p.default.createElement(b,{region:"west",style:{width:200}},p.default.createElement(m.Panel,{title:"\u7ec4\u7ec7\u673a\u6784",fit:!0,border:!0},p.default.createElement(g.default,null),p.default.createElement(M.default,null),p.default.createElement(h.default,null))),p.default.createElement(b,{region:"center"},p.default.createElement(m.Panel,{title:r},p.default.createElement(n.default,{rowKey:"id",size:"middle",bordered:!0,dataSource:l,columns:a,pagination:!1}))),p.default.createElement(b,{region:"east"}))}function o(e){return{dataSource:e.dataSource}}Object.defineProperty(t,"__esModule",{value:!0});var u=(l(67),l(66)),n=r(u),d=(l(85),l(84)),i=r(d),s=(l(27),l(25)),c=r(s),f=l(1),p=r(f),m=l(15),y=l(113),g=r(y),v=l(344),M=r(v),T=l(345),h=r(T);l(49);var b=m.Layout.Box;t.default=(0,m.connect)(o)(a),e.exports=t.default},347:function(e,t,l){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var a=l(348),o=r(a),u=l(15),n=l(346),d=r(n),i=new u.stateContainer;i.model(o.default),i.debug(!0),i.ready(function(e){e({type:"initTreeData"}),e({type:"initModuleTree"}),e({type:"initOrgType"}),e({type:"getCurrentUserType"})}),i.start(d.default,"root")},348:function(e,t,l){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&(t[l]=e[l]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=l(2),u=a(o),n=l(349),d=r(n);t.default={namespace:"role",state:{roleProps:{isNew:!0,editData:{},visible:!1,loading:!1,orgType:[]},moduleProps:{isSet:!0,selectedModules:[],visible:!1,moduleTree:[]},dataSource:[],orgTreeData:[]},reducers:{initTreeData:function(e,t,l,r){d.initOrgTree(t,l,r)},initOrgType:function(e,t,l){d.initOrgType(e,l)},onOrgTreeSelect:function(e,t,l){d.queryRoleList(t.selectTreeKey,l)},refreshRoleList:function(e,t,l){d.queryRoleList(e.selectTreeKey,l)},openRoleModal:function(e,t){var l=e.roleProps;return(0,u.default)(l,t,{visible:!0}),{roleProps:l}},closeRoleModal:function(e,t){var l=e.roleProps;return(0,u.default)(l,{visible:!1}),{roleProps:l}},initModuleTree:function(e,t,l){d.queryModuleTree(e,l)},openModuleModal:function(e,t,l){d.queryRoleModuleList(e,t,l)},closeModuleModal:function(e,t){var l=e.moduleProps;return(0,u.default)(l,{visible:!1}),{moduleProps:l}},saveRole:function(e,t,l,r){d.saveRole(e,t,l,r)},deleteRole:function(e,t,l,r){d.deleteRole(e,t,l,r)},checkModules:function(e,t,l,r){var a=e.moduleProps;return(0,u.default)(a,{selectedModules:d.filterTree(t,a.moduleTree)}),{moduleProps:a}},updateRoleModule:function(e,t,l,r){d.updateRoleModule(e,t,l,r)},isGlobalChange:function(e,t,l,r){var a=e.roleProps;return a.editData.isGlobal=t,{roleProps:a}},getCurrentUserType:function(e,t,l,r){d.getCurrentUserType(e,t,l,r)}}},e.exports=t.default},349:function(e,t,l){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,l){b.request.post("../org/queryOrgTree.do",function(e){var r=null;e&&e.length>0&&(r=e[0].id),t({orgTreeData:e,selectTreeKey:r}),l({type:"onOrgTreeSelect",params:{selectTreeKey:r}})})}function o(e,t){b.request.post("../dict/queryDict.do",{key:"org_type"},function(l){var r=e.roleProps;(0,M.default)(r,{orgType:l}),t({roleProps:r})})}function u(e,t){b.request.post("queryRoleList.do",{orgId:e},function(l){t({dataSource:l,selectTreeKey:e})})}function n(e,t){b.request.post("../module/queryModuleTree.do",function(l){var r=e.moduleProps;(0,M.default)(r,{moduleTree:l}),t({moduleProps:r})})}function d(e,t,l,r){var a=e.roleProps;a.isNew?((0,M.default)(a,{loading:!0}),l(a),b.request.post("insertRole.do",(0,M.default)(t,{toOrgId:e.selectTreeKey}),function(){(0,M.default)(a,{loading:!1,visible:!1}),l(a),r({type:"refreshRoleList"}),g.default.success("\u65b0\u5efa\u89d2\u8272\u6210\u529f\uff01")},function(e){(0,M.default)(a,{loading:!1}),l(a),g.default.success("\u65b0\u5efa\u89d2\u8272\u5931\u8d25\uff01")})):b.request.post("updateRole.do",t,function(){(0,M.default)(a,{loading:!1,visible:!1}),l(a),r({type:"refreshRoleList"}),g.default.success("\u4fee\u6539\u89d2\u8272\u6210\u529f\uff01")},function(e){(0,M.default)(a,{loading:!1}),l(a),g.default.success("\u4fee\u6539\u89d2\u8272\u5931\u8d25\uff01")})}function i(e,t,l,r){E({title:"\u786e\u8ba4\u5220\u9664\u8fd9\u6761\u8bb0\u5f55\u5417\uff1f",onOk:function(){b.request.get("deleteRole.do",t,function(t){g.default.success("\u5220\u9664\u89d2\u8272\u6210\u529f\uff01"),r({type:"onOrgTreeSelect",params:{selectTreeKey:e.selectTreeKey}})})}})}function s(e,t,l){var r=e.moduleProps;(0,M.default)(r,{visible:!0,isSet:t.isSet}),b.request.post("queryRoleModuleList.do",t,function(e){(0,M.default)(r,{selectedModules:e}),l({moduleProps:r,setRoleId:t.roleId})})}function c(e,t,l,r){var a={roleId:e.setRoleId,"modules[]":t.selectedModules};b.request.post("updateRoleModule.do",a,function(e){r({type:"closeModuleModal"}),g.default.success("\u8bbe\u7f6e\u89d2\u8272\u529f\u80fd\u6a21\u5757\u6210\u529f\uff01")})}function f(e,t){for(var l=[],r=0;r<e.length;r++)m(e[r],t)||l.push(e[r]);return l}function p(e,t,l,r){b.request.post("../user/getCurrentUserType.do",function(e){l({currentUserType:e})})}function m(e,t){for(var l=0;l<t.length;l++)if(null!=t[l].children&&t[l].children.length>0)return e==t[l].key||m(e,t[l].children);return!1}Object.defineProperty(t,"__esModule",{value:!0});var y=(l(32),l(29)),g=r(y),v=l(2),M=r(v),T=(l(22),l(21)),h=r(T);t.initOrgTree=a,t.initOrgType=o,t.queryRoleList=u,t.queryModuleTree=n,t.saveRole=d,t.deleteRole=i,t.queryRoleModuleList=s,t.updateRoleModule=c,t.filterTree=f,t.getCurrentUserType=p;var b=l(15),E=h.default.confirm},446:16});